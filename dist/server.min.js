"use strict";var express=require("express"),app=express(),bodyParser=require("body-parser"),_require=require("express-validator"),body=_require.body,validationResult=_require.validationResult,port=process.env.PORT||3e3;app.set("view engine","pug"),app.use(bodyParser.json()),app.use(bodyParser.urlencoded({extended:!0}));var Pool=require("pg").Pool,connectionParams=null;connectionParams=null!=process.env.DATABASE_URL?{connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1}}:{user:"api_user",host:"localhost",database:"api",password:"password",port:5432},console.log(connectionParams);var pool=new Pool(connectionParams);app.get("/",function(e,r){console.log("Accept: "+e.get("Accept")),pool.query("SELECT VERSION()",function(e,s){console.log(e,s.rows),pool.query("SELECT * FROM team_members",function(e,o){console.log(e,o),r.render("index",{teamNumber:5,databaseVersion:s.rows[0].version,teamMembers:o.rows}),console.log("Content-Type: "+r.get("Content-Type"))})})}),app.post("/",body("first_name").isAlpha().isLength({min:1}).withMessage("must be valid"),body("last_name").isAlpha().isLength({min:0}).withMessage("must be valid"),function(e,s){var o=validationResult(e);if(!o.isEmpty())return s.status(400).send({errors:o.array()});pool.query("INSERT INTO team_members (first_name, last_name) VALUES ('".concat(e.body.first_name,"', '").concat(e.body.last_name,"')"),function(e,o){console.log(e,o),s.redirect("/")})}),module.exports=app;
//# sourceMappingURL=server.min.js.map
